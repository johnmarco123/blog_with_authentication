<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet"  type="text/css" href="/main.css" />
    <title>Author Home Page</title>
</head>
<body>
    <h1>Author Home page</h1>
    <a href="/author/settings"><h3>Settings</h3></a>
    <!-- SHOULD CRATE A NEW DRAFT AND GO TO ITS EDIT PAGE --->
    <br>
    <form action="/author/add-draft" method="post">
        <a href="/author/edit"><button>Create new draft</button></a>
    </form>
        <ul>
            <% articles.forEach(function(article){ %>
            <li id="<%=article.article_id%>">
                <h3><%=article.title%>, <%=article.user_name %>, <%=article.created%></h3>
                <button class="edit-article-button">Edit</button>
                <button class="delete-article-button">Delete</button>
            </li>
            <% }) %>
        </ul>
        <script>
            document.querySelectorAll(".edit-article-button").forEach(button => {
                button.addEventListener("click", function() {
                    const id = this.parentNode.id;
                    window.location.href = `/author/edit/${id}`;
                });
            });

            document.querySelectorAll(".delete-article-button").forEach(button => {
                button.addEventListener("click", function() {
                    const id = this.parentNode.id;
                    fetch(`/author/edit/${id}`, { method: "DELETE" })
                        .then(() => window.location.reload(true));
                    ;
                });
            });
        </script>
</body>
</html>
